# PromptGrimoire Environment Configuration
# Copy to .env and fill in your values

# =============================================================================
# Stytch B2B Authentication
# Get these from https://stytch.com/dashboard -> API Keys
# =============================================================================

# Project credentials (use test keys for development)
STYTCH_PROJECT_ID=project-test-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

# Stytch secret API key
STYTCH_SECRET=secret-test-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Public token (for SSO redirects, found in Dashboard -> API Keys)
STYTCH_PUBLIC_TOKEN=public-token-test-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

# Default Organization ID (create in Dashboard -> Organizations)
STYTCH_DEFAULT_ORG_ID=organization-test-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

# SSO Connection ID for AAF (create in Dashboard -> SSO -> OIDC)
# Only needed if using AAF SSO
# Format: oidc-connection-test-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
STYTCH_SSO_CONNECTION_ID=

# =============================================================================
# Application Settings
# =============================================================================

# Base URL for your application (used in magic link callbacks)
BASE_URL=http://localhost:8080

# Port to run the application on
PROMPTGRIMOIRE_PORT=8080

# Secret for encrypting NiceGUI session storage (generate with: python -c "import secrets; print(secrets.token_urlsafe(32))")
# openssl rand 64 | openssl enc -A -base64
STORAGE_SECRET=change-me-generate-a-real-secret

# =============================================================================
# Auth Mode (for testing)
# =============================================================================

# Set to "true" to use MockAuthClient instead of real Stytch
# Useful for development and testing without Stytch credentials
AUTH_MOCK=false

# =============================================================================
# Claude API (for roleplay feature)
# =============================================================================

# Anthropic API key for Claude
ANTHROPIC_API_KEY=sk-ant-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Claude model to use (default: claude-sonnet-4-20250514)
CLAUDE_MODEL=claude-sonnet-4-20250514

# Extended thinking token budget (default: 1024, set to 0 to disable)
CLAUDE_THINKING_BUDGET=1024

# =============================================================================
# Roleplay & Logging
# =============================================================================

# Directory for JSONL roleplay session logs (default: logs/sessions)
ROLEPLAY_LOG_DIR=logs/sessions

# Max tokens for lorebook entries (default: 0 = unlimited)
LOREBOOK_TOKEN_BUDGET=0

# =============================================================================
# Feature Flags
# =============================================================================

# Enable demo pages in navigation (text-selection, crdt-sync, live-annotation)
# Set to "true" in development, disable in production
ENABLE_DEMO_PAGES=false

# =============================================================================
# Database (optional - app works without it)
# =============================================================================

# PostgreSQL connection string (async driver)
# Required for: /case-tool page, annotation persistence
# Optional for: /demo/live-annotation (falls back to in-memory)
# Not used by: /roleplay, /logs, /demo/crdt-sync, /demo/text-selection
#
# Uncomment ONE of the following options:

# Option 1: Local Unix socket (no password needed if pg_hba.conf uses "peer" auth)
# DATABASE_URL=postgresql+asyncpg://your_username@/promptgrimoire?host=/var/run/postgresql

# Option 2: TCP connection with password
# DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/promptgrimoire

# Enable SQL query logging (useful for debugging)
# DATABASE_ECHO=1

# =============================================================================
# PDF Export / LaTeX
# =============================================================================

# Path to latexmk executable for PDF export
# Leave empty to use TinyTeX at ~/.TinyTeX/bin/x86_64-linux/latexmk
# Run `uv run python scripts/setup_latex.py` to install TinyTeX
LATEXMK_PATH=

# =============================================================================
# Test Database (required for running tests)
# =============================================================================

# IMPORTANT: Use a SEPARATE database for tests, not your development database!
# Tests use this to set DATABASE_URL automatically for isolation.
#
# The test suite:
# - Sets DATABASE_URL from TEST_DATABASE_URL at test session start
# - Runs Alembic migrations to ensure schema exists
# - Uses UUID-based isolation (tests don't interfere with each other)
# - Does NOT drop or truncate tables (safe for parallel execution)
#
# TEST_DATABASE_URL=postgresql+asyncpg://your_username@/promptgrimoire_test?host=/var/run/postgresql
